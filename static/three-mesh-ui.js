(()=>{"use strict";var e={d:(t,r)=>{for(var s in r)e.o(r,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:r[s]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};e.r(t),e.d(t,{NORMAL:()=>c,NOWRAP:()=>l,PRE:()=>d,PRE_LINE:()=>u,PRE_WRAP:()=>p,WHITE_CHARS:()=>h,collapseWhitespaceOnInlines:()=>f,collapseWhitespaceOnString:()=>w,newlineBreakability:()=>C,shouldBreak:()=>g});var r={};e.r(r),e.d(r,{CENTER:()=>k,JUSTIFY:()=>_,JUSTIFY_CENTER:()=>P,JUSTIFY_LEFT:()=>S,JUSTIFY_RIGHT:()=>U,LEFT:()=>y,RIGHT:()=>x,alignLines:()=>R});const s=THREE;function a(e){return class extends e{constructor(e){super(e),this.isBoxComponent=!0,this.childrenPos={}}getInnerWidth(){const e=this.getContentDirection();switch(e){case"row":case"row-reverse":return this.width-(2*this.padding||0)||this.getChildrenSideSum("width");case"column":case"column-reverse":return this.getHighestChildSizeOn("width");default:console.error(`Invalid contentDirection : ${e}`)}}getInnerHeight(){const e=this.getContentDirection();switch(e){case"row":case"row-reverse":return this.getHighestChildSizeOn("height");case"column":case"column-reverse":return this.height-(2*this.padding||0)||this.getChildrenSideSum("height");default:console.error(`Invalid contentDirection : ${e}`)}}getChildrenSideSum(e){return this.children.reduce(((t,r)=>{if(!r.isBoxComponent)return t;const s=2*r.margin||0;return t+("width"===e?r.getWidth()+s:r.getHeight()+s)}),0)}setPosFromParentRecords(){this.getUIParent()&&this.getUIParent().childrenPos[this.id]&&(this.position.x=this.getUIParent().childrenPos[this.id].x,this.position.y=this.getUIParent().childrenPos[this.id].y)}computeChildrenPosition(){if(this.children.length>0){let e,t;switch(this.getContentDirection()){case"row":e=this.getInnerWidth()/2,this.setChildrenXPos(-e),this.alignChildrenOnY();break;case"row-reverse":e=this.getInnerWidth()/2,this.setChildrenXPos(e),this.alignChildrenOnY();break;case"column":t=this.getInnerHeight()/2,this.setChildrenYPos(t),this.alignChildrenOnX();break;case"column-reverse":t=this.getInnerHeight()/2,this.setChildrenYPos(-t),this.alignChildrenOnX()}}}direction__rowEndToEndChildren=(e,t)=>{const r=t.id,s=t.getWidth(),a=t.margin||0,i=this.signInvertor;return e+=a*i,this.childrenPos[r]={x:e+s/2*i,y:0},e+i*(s+a)};direction__columnEndToEndChildren=(e,t)=>{const r=t.id,s=t.getHeight(),a=t.margin||0,i=this.signInvertor;return e+=a*i,this.childrenPos[r]={x:0,y:e+s/2*i},e+i*(s+a)};justification__getJustificationOffset(e,t){switch(e){case"end":return t;case"center":return t/2}return 0}justification__getJustificationMargin(e,t,r){const s=Array(e.length).fill(0);if(t>0)switch(r){case"space-between":if(e.length>1){const r=t/(e.length-1)*this.signInvertor;s[0]=0;for(let t=1;t<e.length;t++)s[t]=r*t}break;case"space-evenly":if(e.length>1){const r=t/(e.length+1)*this.signInvertor;for(let t=0;t<e.length;t++)s[t]=r*(t+1)}break;case"space-around":if(e.length>1){const r=t/e.length*this.signInvertor,a=r/2;s[0]=a;for(let t=1;t<e.length;t++)s[t]=a+r*t}}return s}setChildrenXPos(e){const t=this.getJustifyContent();-1===i.indexOf(t)&&console.warn(`justifyContent === '${t}' is not supported`);const r=this.children.filter(o);this.signInvertor=-Math.sign(e),r.reduce(this.direction__rowEndToEndChildren,e);const s=this.getChildrenSideSum("width"),a=this.getInnerWidth()-s,n=2*e-s*Math.sign(e),h=this.justification__getJustificationOffset(t,n),c=this.justification__getJustificationMargin(r,a,t);r.forEach(((e,t)=>{this.childrenPos[e.id].x-=h-c[t]}))}setChildrenYPos(e){const t=this.getJustifyContent();-1===i.indexOf(t)&&console.warn(`justifyContent === '${t}' is not supported`);const r=this.children.filter(o);this.signInvertor=-Math.sign(e),r.reduce(this.direction__columnEndToEndChildren,e);const s=this.getChildrenSideSum("height"),a=this.getInnerHeight()-s,n=2*e-s*Math.sign(e),h=this.justification__getJustificationOffset(t,n),c=this.justification__getJustificationMargin(r,a,t);r.forEach(((e,t)=>{this.childrenPos[e.id].y-=h-c[t]}))}alignChildrenOnX(){const e=this.getAlignItems(),t=this.getWidth()/2-(this.padding||0);-1===n.indexOf(e)&&console.warn(`alignItems === '${e}' is not supported`),this.children.forEach((r=>{if(!r.isBoxComponent)return;let s;"right"===e||"end"===e?s=t-r.getWidth()/2-(r.margin||0):"left"!==e&&"start"!==e||(s=-t+r.getWidth()/2+(r.margin||0)),this.childrenPos[r.id].x=s||0}))}alignChildrenOnY(){const e=this.getAlignItems(),t=this.getHeight()/2-(this.padding||0);-1===n.indexOf(e)&&console.warn(`alignItems === '${e}' is not supported`),this.children.forEach((r=>{if(!r.isBoxComponent)return;let s;"top"===e||"start"===e?s=t-r.getHeight()/2-(r.margin||0):"bottom"!==e&&"end"!==e||(s=-t+r.getHeight()/2+(r.margin||0)),this.childrenPos[r.id].y=s||0}))}getHighestChildSizeOn(e){return this.children.reduce(((t,r)=>{if(!r.isBoxComponent)return t;const s=r.margin||0,a="width"===e?r.getWidth()+2*s:r.getHeight()+2*s;return Math.max(t,a)}),0)}getWidth(){return this.parent&&this.parent.isUI&&"stretch"===this.parent.getAlignItems()&&-1!==this.parent.getContentDirection().indexOf("column")?this.parent.getWidth()-(2*this.parent.padding||0):this.width||this.getInnerWidth()+(2*this.padding||0)}getHeight(){return this.parent&&this.parent.isUI&&"stretch"===this.parent.getAlignItems()&&-1!==this.parent.getContentDirection().indexOf("row")?this.parent.getHeight()-(2*this.parent.padding||0):this.height||this.getInnerHeight()+(2*this.padding||0)}}}const i=["start","center","end","space-around","space-between","space-evenly"],n=["start","center","end","stretch","top","right","bottom","left"],o=e=>e.isBoxComponent,h={"\t":"\t","\n":"\n","\r":"\r"," ":" "},c="normal",l="nowrap",d="pre",u="pre-line",p="pre-wrap",w=function(e,t){switch(t){case l:case c:e=e.replace(/\n/g," ");case u:e=e.replace(/[ ]{2,}/g," ")}return e},C=function(e){switch(e){case d:case p:case u:return"mandatory"}},g=function(e,t,r,s){const a=e[t];switch(s.WHITESPACE){case c:case u:case p:if("mandatory"===a.lineBreak)return!0;const i=a.kerning?a.kerning:0,n=a.xoffset?a.xoffset:0;if(r+(a.xadvance?a.xadvance:a.width)+n+i>s.INNER_WIDTH)return!0;const o=v(e,t,s);return function(e,t,r,s){return!(!e||!e.glyph)&&(!(t+r<s.INNER_WIDTH)&&s.BREAKON.indexOf(e.glyph)>-1)}(e[t-1],r,o,s);case d:return"mandatory"===a.lineBreak;default:return!1}},f=function(e,t){const r=e[0],s=e[e.length-1];switch(t){case p:r.glyph&&"\n"===r.glyph&&e.length>1&&b([r],e[1]),s.glyph&&"\n"===s.glyph&&e.length>1&&m([s],e[e.length-2]);break;case u:case l:case c:let a,i=[];for(let t=0;t<e.length;t++){const r=e[t];if(!(r.glyph&&h[r.glyph]&&e.length>t))break;i.push(r),a=e[t+1]}b(i,a),i=[],a=null;for(let t=e.length-1;t>0;t--){const r=e[t];if(!(r.glyph&&h[r.glyph]&&t>0))break;i.push(r),a=e[t-1]}m(i,a);break;case d:break;default:return console.warn(`whiteSpace: '${t}' is not valid`),0}return r.offsetX};function m(e,t){if(t)for(let r=0;r<e.length;r++){const s=e[r];s.width=0,s.height=0,s.offsetX=t.offsetX+t.width}}function b(e,t){if(t)for(let r=0;r<e.length;r++){const s=e[r];s.width=0,s.height=0,s.offsetX=t.offsetX}}function v(e,t,r,s){if(s=s||0,!e[t])return s;const a=e[t],i=a.kerning?a.kerning:0,n=a.xoffset?a.xoffset:0,o=a.xadvance?a.xadvance:a.width;return a.lineBreak?s+o:v(e,t+1,r,s+o+r.LETTERSPACING+n+i)}const y="left",x="right",k="center",_="justify",S="justify-left",U="justify-right",P="justify-center";function R(e,t,r){for(let s=0;s<e.length;s++){const a=e[s],i=T(a,t,r,s===e.length-1);for(let e=0;e<a.length;e++)a[e].offsetX+=i}if(0===t.indexOf(_))for(let s=0;s<e.length;s++){const a=e[s];if(-1!==t.indexOf("-")&&s===e.length-1)return;const i=r-a.width;if(i<=0)return;let n=0;for(let e=1;e<a.length-1;e++)n+=" "===a[e].glyph?1:0;const o=i/n;let h=1;t===U&&(a.reverse(),h=-1);let c=0;for(let e=1;e<=a.length-1;e++){const t=a[e];t.offsetX+=c*h,c+=" "===t.glyph?o:0}t===U&&a.reverse()}}const T=(e,t,r,s)=>{switch(t){case S:case _:case y:return-r/2;case U:case x:return-e.width+r/2;case k:return-e.width/2;case P:return s?-e.width/2:-r/2;default:console.warn(`textAlign: '${t}' is not valid`)}};function B(e){return class extends e{computeInlinesPosition(){const e=this.getWidth()-(2*this.padding||0),t=this.getHeight()-(2*this.padding||0),r=this.getJustifyContent(),s=this.getTextAlign(),a=this.getInterLine(),i=this.computeLines();let n=i.reduce(((e,t,r,s)=>{const i=t.lineHeight-t.lineBase;return t.forEach((r=>{r.offsetY=e-t.lineHeight+i+s[0].lineHeight})),e-t.lineHeight-a}),0)+a;n=Math.abs(n);const o=(()=>{switch(r){case"start":return t/2-i[0].lineHeight;case"end":return n-i[0].lineHeight-t/2+(i[i.length-1].lineHeight-i[i.length-1].lineHeight);case"center":return n/2-i[0].lineHeight;default:console.warn(`justifyContent: '${r}' is not valid`)}})();i.forEach((e=>{e.forEach((e=>{e.offsetY+=o}))})),R(i,s,e),this.lines=i}calculateBestFit(e){const t=this.children.filter((e=>!!e.isInline));if(0!==t.length)switch(e){case"grow":this.calculateGrowFit(t);break;case"shrink":this.calculateShrinkFit(t);break;case"auto":this.calculateAutoFit(t)}}calculateGrowFit(e){const t=this.getHeight()-(2*this.padding||0);let r=1;const s=e.find((e=>e.isText));let a,i=1,n=2,o=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(a=this.calculateHeight(e,o),a>t){if(o<=i){e.forEach((e=>{e.isInlineBlock||(e._fitFontSize=e.getFontSize())}));break}n=o,o-=(n-i)/2}else{if(Math.abs(t-a)<.075)break;Math.abs(o-n)<5e-10&&(n*=2),i=o,o+=(n-i)/2}}while(++r<=10)}calculateShrinkFit(e){const t=this.getHeight()-(2*this.padding||0);let r=1;const s=e.find((e=>e.isText));let a,i=0,n=1,o=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(a=this.calculateHeight(e,o),a>t)n=o,o-=(n-i)/2;else{if(o>=n){e.forEach((e=>{e.isInlineBlock||(e._fitFontSize=e.getFontSize())}));break}if(Math.abs(t-a)<.075)break;i=o,o+=(n-i)/2}}while(++r<=10)}calculateAutoFit(e){const t=this.getHeight()-(2*this.padding||0);let r=1;const s=e.find((e=>e.isText));let a,i=0,n=2,o=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(a=this.calculateHeight(e,o),a>t)n=o,o-=(n-i)/2;else{if(Math.abs(t-a)<.075)break;Math.abs(o-n)<5e-10&&(n*=2),i=o,o+=(n-i)/2}}while(++r<=10)}computeLines(){const e=this.getWidth()-(2*this.padding||0),t=[[]];return this.children.filter((e=>!!e.isInline)).reduce(((r,s)=>{if(!s.inlines)return;const a=s._fitFontSize||s.getFontSize(),i=s.isText?s.getLetterSpacing()*a:0,n=s.getWhiteSpace(),o=s.getBreakOn(),h={WHITESPACE:n,LETTERSPACING:i,BREAKON:o,INNER_WIDTH:e};return s.inlines.reduce(((e,r,s,a)=>{const n=r.kerning?r.kerning:0,o=r.xoffset?r.xoffset:0,c=r.xadvance?r.xadvance:r.width;return g(a,s,e,h)?(t.push([r]),r.offsetX=o,0===r.width?0:c+i):(t[t.length-1].push(r),r.offsetX=e+o+n,e+c+n+i)}),r)}),0),t.forEach((e=>{e.lineHeight=e.reduce(((e,t)=>{const r=void 0!==t.lineHeight?t.lineHeight:t.height;return Math.max(e,r)}),0),e.lineBase=e.reduce(((e,t)=>{const r=void 0!==t.lineBase?t.lineBase:t.height;return Math.max(e,r)}),0),e.width=0;if(e[0]){const t=this.getWhiteSpace(),r=f(e,t);e.forEach((e=>{e.offsetX-=r})),e.width=this.computeLineWidth(e)}})),t}calculateHeight(e,t){e.forEach((e=>{e.isInlineBlock||(e._fitFontSize=e.getFontSize()*t,e.calculateInlines(e._fitFontSize))}));const r=this.computeLines(),s=this.getInterLine(),a=r.reduce(((e,t)=>e-t.lineHeight-s),0)+s;return Math.abs(a)}computeLineWidth(e){const t=e[0],r=e[e.length-1];return Math.abs(t.offsetX-(r.offsetX+r.width))}}}const O=new s.FileLoader,I=[],F={},E=new s.TextureLoader,z=[],H={},M={};function D(e){if(e._kernings)return;const t={};for(let r=0;r<e.kernings.length;r++){const s=e.kernings[r];if(0===s.amount)continue;t[String.fromCharCode(s.first,s.second)]=s.amount}e._kernings=t}const L={setFontFamily:function(e,t){"string"==typeof t?function(e,t){-1===I.indexOf(t)&&(I.push(t),O.load(t,(e=>{const r=JSON.parse(e);D(r),F[t]=r;for(const e of Object.keys(M))t===M[e].jsonURL&&M[e].component._updateFontFamily(r)})));M[e.id]||(M[e.id]={component:e});M[e.id].jsonURL=t,F[t]&&e._updateFontFamily(F[t])}(e,t):(M[e.id]||(M[e.id]={component:e}),D(t),M[e.id].json=t,e._updateFontFamily(t))},setFontTexture:function(e,t){-1===z.indexOf(t)&&(z.push(t),E.load(t,(e=>{e.generateMipmaps=!1,e.minFilter=s.LinearFilter,e.magFilter=s.LinearFilter,H[t]=e;for(const r of Object.keys(M))t===M[r].textureURL&&M[r].component._updateFontTexture(e)}))),M[e.id]||(M[e.id]={component:e}),M[e.id].textureURL=t,H[t]&&e._updateFontTexture(H[t])},getFontOf:function e(t){const r=M[t.id];return!r&&t.getUIParent()?e(t.getUIParent()):r},addFont:function(e,t,r){r.generateMipmaps=!1,r.minFilter=s.LinearFilter,r.magFilter=s.LinearFilter,I.push(e),F[e]=t,D(t),r&&(z.push(e),H[e]=r)}},A=L;class W{static requestUpdate(e,t,r,s){e.traverse((e=>{e.isUI&&(this.requestedUpdates[e.id]?(t&&(this.requestedUpdates[e.id].updateParsing=!0),r&&(this.requestedUpdates[e.id].updateLayout=!0),s&&(this.requestedUpdates[e.id].updateInner=!0)):this.requestedUpdates[e.id]={updateParsing:t,updateLayout:r,updateInner:s,needCallback:t||r||s})}))}static register(e){this.components.includes(e)||this.components.push(e)}static disposeOf(e){const t=this.components.indexOf(e);t>-1&&this.components.splice(t,1)}static update(){if(Object.keys(this.requestedUpdates).length>0){const e=this.components.filter((e=>!e.getUIParent()));e.forEach((e=>this.traverseParsing(e))),e.forEach((e=>this.traverseUpdates(e)))}}static traverseParsing(e){const t=this.requestedUpdates[e.id];t&&t.updateParsing&&(e.parseParams(),t.updateParsing=!1),e.getUIChildren().forEach((e=>this.traverseParsing(e)))}static traverseUpdates(e){const t=this.requestedUpdates[e.id];delete this.requestedUpdates[e.id],t&&t.updateLayout&&(t.updateLayout=!1,e.updateLayout()),t&&t.updateInner&&(t.updateInner=!1,e.updateInner()),e.getUIChildren().forEach((e=>{this.traverseUpdates(e)})),t&&t.needCallback&&e.onAfterUpdate()}}W.components=[],W.requestedUpdates={};const G={container:null,fontFamily:null,fontSize:.05,fontKerning:"normal",bestFit:"none",offset:.01,interLine:.01,breakOn:"- ,.:?!\n",whiteSpace:u,contentDirection:"column",alignItems:"center",justifyContent:"start",fontTexture:null,textAlign:k,textType:"MSDF",fontColor:new s.Color(16777215),fontOpacity:1,fontPXRange:4,fontSupersampling:!0,borderRadius:.01,borderWidth:0,borderColor:new s.Color("black"),borderOpacity:1,backgroundSize:"cover",backgroundColor:new s.Color(2236962),backgroundWhiteColor:new s.Color(16777215),backgroundOpacity:.8,backgroundOpaqueOpacity:1,backgroundTexture:function(){if(!j){const e=document.createElement("canvas").getContext("2d");e.canvas.width=1,e.canvas.height=1,e.fillStyle="#ffffff",e.fillRect(0,0,1,1),j=new s.CanvasTexture(e.canvas),j.isDefault=!0}return j},hiddenOverflow:!1,letterSpacing:0};let j;function X(e){return class extends e{constructor(e){super(e),this.states={},this.currentState=void 0,this.isUI=!0,this.autoLayout=!0}getClippingPlanes(){const e=[];if(this.parent&&this.parent.isUI){if(this.isBlock&&this.parent.getHiddenOverflow()){const t=this.parent.getHeight()/2-(this.parent.padding||0),r=this.parent.getWidth()/2-(this.parent.padding||0),a=[new s.Plane(new s.Vector3(0,1,0),t),new s.Plane(new s.Vector3(0,-1,0),t),new s.Plane(new s.Vector3(1,0,0),r),new s.Plane(new s.Vector3(-1,0,0),r)];a.forEach((e=>{e.applyMatrix4(this.parent.matrixWorld)})),e.push(...a)}this.parent.parent&&this.parent.parent.isUI&&e.push(...this.parent.getClippingPlanes())}return e}getUIChildren(){return this.children.filter((e=>e.isUI))}getUIParent(){return this.parent&&this.parent.isUI?this.parent:null}getHighestParent(){return this.getUIParent()?this.parent.getHighestParent():this}_getProperty(e){return void 0===this[e]&&this.getUIParent()?this.parent._getProperty(e):void 0!==this[e]?this[e]:G[e]}getFontSize(){return this._getProperty("fontSize")}getFontKerning(){return this._getProperty("fontKerning")}getLetterSpacing(){return this._getProperty("letterSpacing")}getFontTexture(){return this._getProperty("fontTexture")}getFontFamily(){return this._getProperty("fontFamily")}getBreakOn(){return this._getProperty("breakOn")}getWhiteSpace(){return this._getProperty("whiteSpace")}getTextAlign(){return this._getProperty("textAlign")}getTextType(){return this._getProperty("textType")}getFontColor(){return this._getProperty("fontColor")}getFontSupersampling(){return this._getProperty("fontSupersampling")}getFontOpacity(){return this._getProperty("fontOpacity")}getFontPXRange(){return this._getProperty("fontPXRange")}getBorderRadius(){return this._getProperty("borderRadius")}getBorderWidth(){return this._getProperty("borderWidth")}getBorderColor(){return this._getProperty("borderColor")}getBorderOpacity(){return this._getProperty("borderOpacity")}getContainer(){return!this.threeOBJ&&this.parent?this.parent.getContainer():this.threeOBJ?this:G.container}getParentsNumber(e){return e=e||0,this.getUIParent()?this.parent.getParentsNumber(e+1):e}getBackgroundOpacity(){return this.backgroundOpacity||0===this.backgroundOpacity?this.backgroundOpacity:G.backgroundOpacity}getBackgroundColor(){return this.backgroundColor||G.backgroundColor}getBackgroundTexture(){return this.backgroundTexture||G.backgroundTexture()}getAlignContent(){return this.alignContent||G.alignContent}getAlignItems(){return this.alignItems||G.alignItems}getContentDirection(){return this.contentDirection||G.contentDirection}getJustifyContent(){return this.justifyContent||G.justifyContent}getInterLine(){return void 0===this.interLine?G.interLine:this.interLine}getOffset(){return void 0===this.offset?G.offset:this.offset}getBackgroundSize(){return void 0===this.backgroundSize?G.backgroundSize:this.backgroundSize}getHiddenOverflow(){return void 0===this.hiddenOverflow?G.hiddenOverflow:this.hiddenOverflow}getBestFit(){return void 0===this.bestFit?G.bestFit:this.bestFit}add(){for(const e of Object.keys(arguments))arguments[e].isInline&&this.update(null,!0);return super.add(...arguments)}remove(){for(const e of Object.keys(arguments))arguments[e].isInline&&this.update(null,!0);return super.remove(...arguments)}update(e,t,r){W.requestUpdate(this,e,t,r)}onAfterUpdate(){}_updateFontFamily(e){this.fontFamily=e,this.traverse((e=>{e.isUI&&e.update(!0,!0,!1)})),this.getHighestParent().update(!1,!0,!1)}_updateFontTexture(e){this.fontTexture=e,this.getHighestParent().update(!1,!0,!1)}set(e){let t,r,s;if(W.register(this),!e||JSON.stringify(e)===JSON.stringify({}))return;var a;e.alignContent&&(e.alignItems=e.alignContent,e.textAlign||(e.textAlign=e.alignContent),console.warn("`alignContent` property has been deprecated, please rely on `alignItems` and `textAlign` instead."),delete e.alignContent),e.alignItems&&(a=e.alignItems,-1!==N.indexOf(a)&&console.warn(`alignItems === '${a}' is deprecated and will be remove in 7.x.x. Fallback are 'start'|'end'`));for(const a of Object.keys(e))if(this[a]!=e[a])switch(a){case"content":case"fontSize":case"fontKerning":case"breakOn":case"whiteSpace":this.isText&&(t=!0),r=!0,this[a]=e[a];break;case"bestFit":this.isBlock&&(t=!0,r=!0),this[a]=e[a];break;case"width":case"height":case"padding":(this.isInlineBlock||this.isBlock&&"none"!=this.getBestFit())&&(t=!0),r=!0,this[a]=e[a];break;case"letterSpacing":case"interLine":this.isBlock&&"none"!=this.getBestFit()&&(t=!0),r=!0,this[a]=e[a];break;case"margin":case"contentDirection":case"justifyContent":case"alignContent":case"alignItems":case"textAlign":case"textType":r=!0,this[a]=e[a];break;case"fontColor":case"fontOpacity":case"fontSupersampling":case"offset":case"backgroundColor":case"backgroundOpacity":case"backgroundTexture":case"backgroundSize":case"borderRadius":case"borderWidth":case"borderColor":case"borderOpacity":s=!0,this[a]=e[a];break;case"hiddenOverflow":this[a]=e[a]}e.fontFamily&&A.setFontFamily(this,e.fontFamily),e.fontTexture&&A.setFontTexture(this,e.fontTexture);const i=this.getUIParent();i&&"none"!=i.getBestFit()&&i.update(!0,!0,!1),this.update(t,r,s),r&&this.getHighestParent().update(!1,!0,!1)}setupState(e){this.states[e.state]={attributes:e.attributes,onSet:e.onSet}}setState(e){const t=this.states[e];t?e!==this.currentState&&(this.currentState=e,t.onSet&&t.onSet(),t.attributes&&this.set(t.attributes)):console.warn(`state "${e}" does not exist within this component`)}clear(){this.traverse((e=>{W.disposeOf(e),e.material&&e.material.dispose(),e.geometry&&e.geometry.dispose()}))}}}const N=["top","right","bottom","left"];function Y(e){return class extends e{constructor(e){super(e),this.textUniforms={u_texture:{value:null},u_color:{value:null},u_opacity:{value:null},u_pxRange:{value:null},u_useRGSS:{value:null}},this.backgroundUniforms={u_texture:{value:null},u_color:{value:null},u_opacity:{value:null},u_backgroundMapping:{value:null},u_borderWidth:{value:null},u_borderColor:{value:null},u_borderRadiusTopLeft:{value:null},u_borderRadiusTopRight:{value:null},u_borderRadiusBottomRight:{value:null},u_borderRadiusBottomLeft:{value:null},u_borderOpacity:{value:null},u_size:{value:new s.Vector2(1,1)},u_tSize:{value:new s.Vector2(1,1)}}}updateBackgroundMaterial(){this.backgroundUniforms.u_texture.value=this.getBackgroundTexture(),this.backgroundUniforms.u_tSize.value.set(this.backgroundUniforms.u_texture.value.image.width,this.backgroundUniforms.u_texture.value.image.height),this.size&&this.backgroundUniforms.u_size.value.copy(this.size),this.backgroundUniforms.u_texture.value.isDefault?(this.backgroundUniforms.u_color.value=this.getBackgroundColor(),this.backgroundUniforms.u_opacity.value=this.getBackgroundOpacity()):(this.backgroundUniforms.u_color.value=this.backgroundColor||G.backgroundWhiteColor,this.backgroundUniforms.u_opacity.value=this.backgroundOpacity||0===this.backgroundOpacity?this.backgroundOpacity:G.backgroundOpaqueOpacity),this.backgroundUniforms.u_backgroundMapping.value=(()=>{switch(this.getBackgroundSize()){case"stretch":return 0;case"contain":return 1;case"cover":return 2}})();const e=this.getBorderRadius();this.backgroundUniforms.u_borderWidth.value=this.getBorderWidth(),this.backgroundUniforms.u_borderColor.value=this.getBorderColor(),this.backgroundUniforms.u_borderOpacity.value=this.getBorderOpacity(),Array.isArray(e)?(this.backgroundUniforms.u_borderRadiusTopLeft.value=e[0],this.backgroundUniforms.u_borderRadiusTopRight.value=e[1],this.backgroundUniforms.u_borderRadiusBottomRight.value=e[2],this.backgroundUniforms.u_borderRadiusBottomLeft.value=e[3]):(this.backgroundUniforms.u_borderRadiusTopLeft.value=e,this.backgroundUniforms.u_borderRadiusTopRight.value=e,this.backgroundUniforms.u_borderRadiusBottomRight.value=e,this.backgroundUniforms.u_borderRadiusBottomLeft.value=e)}updateTextMaterial(){this.textUniforms.u_texture.value=this.getFontTexture(),this.textUniforms.u_color.value=this.getFontColor(),this.textUniforms.u_opacity.value=this.getFontOpacity(),this.textUniforms.u_pxRange.value=this.getFontPXRange(),this.textUniforms.u_useRGSS.value=this.getFontSupersampling()}getBackgroundMaterial(){return this.backgroundMaterial&&this.backgroundUniforms||(this.backgroundMaterial=this._makeBackgroundMaterial()),this.backgroundMaterial}getFontMaterial(){return this.fontMaterial&&this.textUniforms||(this.fontMaterial=this._makeTextMaterial()),this.fontMaterial}_makeTextMaterial(){return new s.ShaderMaterial({uniforms:this.textUniforms,transparent:!0,clipping:!0,vertexShader:V,fragmentShader:J,extensions:{derivatives:!0}})}_makeBackgroundMaterial(){return new s.ShaderMaterial({uniforms:this.backgroundUniforms,transparent:!0,clipping:!0,vertexShader:q,fragmentShader:K,extensions:{derivatives:!0}})}updateClippingPlanes(e){const t=void 0!==e?e:this.getClippingPlanes();JSON.stringify(t)!==JSON.stringify(this.clippingPlanes)&&(this.clippingPlanes=t,this.fontMaterial&&(this.fontMaterial.clippingPlanes=this.clippingPlanes),this.backgroundMaterial&&(this.backgroundMaterial.clippingPlanes=this.clippingPlanes))}}}const V="\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvUv = uv;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\tgl_Position.z -= 0.00001;\n\n\t#include <clipping_planes_vertex>\n\n}\n",J="\n\nuniform sampler2D u_texture;\nuniform vec3 u_color;\nuniform float u_opacity;\nuniform float u_pxRange;\nuniform bool u_useRGSS;\n\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_fragment>\n\n// functions from the original msdf repo:\n// https://github.com/Chlumsky/msdfgen#using-a-multi-channel-distance-field\n\nfloat median(float r, float g, float b) {\n\treturn max(min(r, g), min(max(r, g), b));\n}\n\nfloat screenPxRange() {\n\tvec2 unitRange = vec2(u_pxRange)/vec2(textureSize(u_texture, 0));\n\tvec2 screenTexSize = vec2(1.0)/fwidth(vUv);\n\treturn max(0.5*dot(unitRange, screenTexSize), 1.0);\n}\n\nfloat tap(vec2 offsetUV) {\n\tvec3 msd = texture( u_texture, offsetUV ).rgb;\n\tfloat sd = median(msd.r, msd.g, msd.b);\n\tfloat screenPxDistance = screenPxRange() * (sd - 0.5);\n\tfloat alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n\treturn alpha;\n}\n\nvoid main() {\n\n\tfloat alpha;\n\n\tif ( u_useRGSS ) {\n\n\t\t// shader-based supersampling based on https://bgolus.medium.com/sharper-mipmapping-using-shader-based-supersampling-ed7aadb47bec\n\t\t// per pixel partial derivatives\n\t\tvec2 dx = dFdx(vUv);\n\t\tvec2 dy = dFdy(vUv);\n\n\t\t// rotated grid uv offsets\n\t\tvec2 uvOffsets = vec2(0.125, 0.375);\n\t\tvec2 offsetUV = vec2(0.0, 0.0);\n\n\t\t// supersampled using 2x2 rotated grid\n\t\talpha = 0.0;\n\t\toffsetUV.xy = vUv + uvOffsets.x * dx + uvOffsets.y * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv - uvOffsets.x * dx - uvOffsets.y * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv + uvOffsets.y * dx - uvOffsets.x * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv - uvOffsets.y * dx + uvOffsets.x * dy;\n\t\talpha += tap(offsetUV);\n\t\talpha *= 0.25;\n\n\t} else {\n\n\t\talpha = tap( vUv );\n\n\t}\n\n\n\t// apply the opacity\n\talpha *= u_opacity;\n\n\t// this is useful to avoid z-fighting when quads overlap because of kerning\n\tif ( alpha < 0.02) discard;\n\n\n\tgl_FragColor = vec4( u_color, alpha );\n\n\t#include <clipping_planes_fragment>\n\n}\n",q="\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvUv = uv;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <clipping_planes_vertex>\n\n}\n",K="\n\nuniform sampler2D u_texture;\nuniform vec3 u_color;\nuniform float u_opacity;\n\nuniform float u_borderRadiusTopLeft;\nuniform float u_borderRadiusTopRight;\nuniform float u_borderRadiusBottomLeft;\nuniform float u_borderRadiusBottomRight;\nuniform float u_borderWidth;\nuniform vec3 u_borderColor;\nuniform float u_borderOpacity;\nuniform vec2 u_size;\nuniform vec2 u_tSize;\nuniform int u_backgroundMapping;\n\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_fragment>\n\nfloat getEdgeDist() {\n\tvec2 ndc = vec2( vUv.x * 2.0 - 1.0, vUv.y * 2.0 - 1.0 );\n\tvec2 planeSpaceCoord = vec2( u_size.x * 0.5 * ndc.x, u_size.y * 0.5 * ndc.y );\n\tvec2 corner = u_size * 0.5;\n\tvec2 offsetCorner = corner - abs( planeSpaceCoord );\n\tfloat innerRadDist = min( offsetCorner.x, offsetCorner.y ) * -1.0;\n\tif (vUv.x < 0.5 && vUv.y >= 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusTopLeft, 0.0 ) ) - u_borderRadiusTopLeft;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusTopLeft );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x >= 0.5 && vUv.y >= 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusTopRight, 0.0 ) ) - u_borderRadiusTopRight;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusTopRight );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x >= 0.5 && vUv.y < 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusBottomRight, 0.0 ) ) - u_borderRadiusBottomRight;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusBottomRight );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x < 0.5 && vUv.y < 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusBottomLeft, 0.0 ) ) - u_borderRadiusBottomLeft;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusBottomLeft );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n}\n\nvec4 sampleTexture() {\n\tfloat textureRatio = u_tSize.x / u_tSize.y;\n\tfloat panelRatio = u_size.x / u_size.y;\n\tvec2 uv = vUv;\n\tif ( u_backgroundMapping == 1 ) { // contain\n\t\tif ( textureRatio < panelRatio ) { // repeat on X\n\t\t\tfloat newX = uv.x * ( panelRatio / textureRatio );\n\t\t\tnewX += 0.5 - 0.5 * ( panelRatio / textureRatio );\n\t\t\tuv.x = newX;\n\t\t} else { // repeat on Y\n\t\t\tfloat newY = uv.y * ( textureRatio / panelRatio );\n\t\t\tnewY += 0.5 - 0.5 * ( textureRatio / panelRatio );\n\t\t\tuv.y = newY;\n\t\t}\n\t} else if ( u_backgroundMapping == 2 ) { // cover\n\t\tif ( textureRatio < panelRatio ) { // stretch on Y\n\t\t\tfloat newY = uv.y * ( textureRatio / panelRatio );\n\t\t\tnewY += 0.5 - 0.5 * ( textureRatio / panelRatio );\n\t\t\tuv.y = newY;\n\t\t} else { // stretch on X\n\t\t\tfloat newX = uv.x * ( panelRatio / textureRatio );\n\t\t\tnewX += 0.5 - 0.5 * ( panelRatio / textureRatio );\n\t\t\tuv.x = newX;\n\t\t}\n\t}\n\treturn texture2D( u_texture, uv ).rgba;\n}\n\nvoid main() {\n\n\tfloat edgeDist = getEdgeDist();\n\tfloat change = fwidth( edgeDist );\n\n\tvec4 textureSample = sampleTexture();\n\tvec3 blendedColor = textureSample.rgb * u_color;\n\n\tfloat alpha = smoothstep( change, 0.0, edgeDist );\n\tfloat blendedOpacity = u_opacity * textureSample.a * alpha;\n\n\tvec4 frameColor = vec4( blendedColor, blendedOpacity );\n\n\tif ( u_borderWidth <= 0.0 ) {\n\t\tgl_FragColor = frameColor;\n\t} else {\n\t\tvec4 borderColor = vec4( u_borderColor, u_borderOpacity * alpha );\n\t\tfloat stp = smoothstep( edgeDist + change, edgeDist, u_borderWidth * -1.0 );\n\t\tgl_FragColor = mix( frameColor, borderColor, stp );\n\t}\n\n\t#include <clipping_planes_fragment>\n}\n";class $ extends s.Mesh{constructor(e){super(new s.PlaneGeometry,e),this.castShadow=!0,this.receiveShadow=!0,this.name="MeshUI-Frame"}}let Q=null;function Z(...e){if(!Q)throw new Error("Cannot use mixins with Base null");let t=Q;Q=null;let r,s=e.length;for(;--s>=0;)r=e[s],t=r(t);return t}Z.withBase=e=>(Q=e,Z);class ee extends(Z.withBase(s.Object3D)(a,B,Y,X)){constructor(e){super(e),this.isBlock=!0,this.size=new s.Vector2(1,1),this.frame=new $(this.getBackgroundMaterial()),this.frame.onBeforeRender=()=>{this.updateClippingPlanes&&this.updateClippingPlanes()},this.add(this.frame),this.set(e)}parseParams(){const e=this.getBestFit();"none"!=e&&this.children.find((e=>e.isText))?this.calculateBestFit(e):this.children.filter((e=>e.isText)).forEach((e=>{e._fitFontSize=void 0}))}updateLayout(){const e=this.getWidth(),t=this.getHeight();e&&t?(this.size.set(e,t),this.frame.scale.set(e,t,1),this.frame&&this.updateBackgroundMaterial(),this.frame.renderOrder=this.getParentsNumber(),this.autoLayout&&this.setPosFromParentRecords(),this.children.find((e=>e.isInline))&&this.computeInlinesPosition(),this.computeChildrenPosition(),this.getUIParent()&&(this.position.z=this.getOffset())):console.warn("Block got no dimension from its parameters or from children parameters")}updateInner(){this.getUIParent()&&(this.position.z=this.getOffset()),this.frame&&this.updateBackgroundMaterial()}}function te(e){return class extends e{constructor(e){super(e),this.isInline=!0}}}function re(e){let t,r,a,i=0;for(let s=0;s<e.length;++s){const n=e[s];if(n.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=n.array.constructor),t!==n.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===r&&(r=n.itemSize),r!==n.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===a&&(a=n.normalized),a!==n.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;i+=n.array.length}const n=new t(i);let o=0;for(let t=0;t<e.length;++t)n.set(e[t].array,o),o+=e[t].array.length;return new s.BufferAttribute(n,r,a)}class se extends s.PlaneBufferGeometry{constructor(e,t){const r=e.glyph,s=e.fontSize;super(s,s),null===r.match(/\s/g)?(-1===t.info.charset.indexOf(r)&&console.error(`The character '${r}' is not included in the font characters set.`),this.mapUVs(t,r),this.transformGeometry(t,s,r,e)):(this.nullifyUVs(),this.scale(0,0,1),this.translate(0,s/2,0))}mapUVs(e,t){const r=e.chars.find((e=>e.char===t)),s=e.common,a=r.x/s.scaleW,i=(r.x+r.width)/s.scaleW,n=1-(r.y+r.height)/s.scaleH,o=1-r.y/s.scaleH,h=this.attributes.uv;for(let e=0;e<h.count;e++){let t=h.getX(e),r=h.getY(e);[t,r]=(()=>{switch(e){case 0:return[a,o];case 1:return[i,o];case 2:return[a,n];case 3:return[i,n]}})(),h.setXY(e,t,r)}}nullifyUVs(){const e=this.attributes.uv;for(let t=0;t<e.count;t++)e.setXY(t,0,0)}transformGeometry(e,t,r,s){const a=e.chars.find((e=>e.char===r)),i=e.common,n=a.height/i.lineHeight,o=a.width*n/a.height;this.scale(o,n,1),this.translate(s.width/2,s.height/2-s.anchor,0)}}const ae={getGlyphDimensions:function(e){const t=e.font,r=e.fontSize,s=e.glyph,a=r/t.info.size,i=t.chars.find((e=>e.char===s));let n=i?i.width*a:r/3,o=i?i.height*a:0;0===n&&(n=i?i.xadvance*a:r),0===o&&(o=.7*r),"\n"===s&&(n=0);const h=i?i.xadvance*a:n,c=i?i.xoffset*a:0;return{width:n,height:o,anchor:i?(i.yoffset+i.height-t.common.base)*r/t.common.lineHeight:0,xadvance:h,xoffset:c}},getGlyphPairKerning:function(e,t){const r=e._kernings;return r[t]?r[t]:0},buildText:function(){const e=[];this.inlines.forEach(((t,r)=>{e[r]=new se(t,this.getFontFamily()),e[r].translate(t.offsetX,t.offsetY,0)}));const t=function(e,t=!1){const r=null!==e[0].index,a=new Set(Object.keys(e[0].attributes)),i=new Set(Object.keys(e[0].morphAttributes)),n={},o={},h=e[0].morphTargetsRelative,c=new s.BufferGeometry;let l=0;for(let s=0;s<e.length;++s){const d=e[s];let u=0;if(r!==(null!==d.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const e in d.attributes){if(!a.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.'),null;void 0===n[e]&&(n[e]=[]),n[e].push(d.attributes[e]),u++}if(u!==a.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+". Make sure all geometries have the same number of attributes."),null;if(h!==d.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const e in d.morphAttributes){if(!i.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[e]&&(o[e]=[]),o[e].push(d.morphAttributes[e])}if(c.userData.mergedUserData=c.userData.mergedUserData||[],c.userData.mergedUserData.push(d.userData),t){let e;if(r)e=d.index.count;else{if(void 0===d.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+s+". The geometry must have either an index or a position attribute"),null;e=d.attributes.position.count}c.addGroup(l,e,s),l+=e}}if(r){let t=0;const r=[];for(let s=0;s<e.length;++s){const a=e[s].index;for(let e=0;e<a.count;++e)r.push(a.getX(e)+t);t+=e[s].attributes.position.count}c.setIndex(r)}for(const e in n){const t=re(n[e]);if(!t)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+e+" attribute."),null;c.setAttribute(e,t)}for(const e in o){const t=o[e][0].length;if(0===t)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[e]=[];for(let r=0;r<t;++r){const t=[];for(let s=0;s<o[e].length;++s)t.push(o[e][s][r]);const s=re(t);if(!s)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+e+" morphAttribute."),null;c.morphAttributes[e].push(s)}}return c}(e);return new s.Mesh(t,this.getFontMaterial())}};function ie(e){return class extends e{createText(){const e=this,t=(()=>{if("MSDF"===this.getTextType())return ae.buildText.call(this);console.warn(`'${this.getTextType()}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)})();return t.renderOrder=1/0,t.onBeforeRender=function(){e.updateClippingPlanes&&e.updateClippingPlanes()},t}getGlyphDimensions(e){if("MSDF"===e.textType)return ae.getGlyphDimensions(e);console.warn(`'${e.textType}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)}getGlyphPairKerning(e,t,r){if("MSDF"===e)return ae.getGlyphPairKerning(t,r);console.warn(`'${e}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)}}}const ne=function e(t){t.children.forEach((r=>{r.children.length>0&&e(r),t.remove(r),W.disposeOf(r),r.material&&r.material.dispose(),r.geometry&&r.geometry.dispose()})),t.children=[]};class oe extends(Z.withBase(s.Object3D)(te,ie,Y,X)){constructor(e){super(e),this.isText=!0,this.set(e)}parseParams(){this.calculateInlines(this._fitFontSize||this.getFontSize())}updateLayout(){ne(this),this.inlines&&(this.textContent=this.createText(),this.updateTextMaterial(),this.add(this.textContent)),this.position.z=this.getOffset()}updateInner(){this.position.z=this.getOffset(),this.textContent&&this.updateTextMaterial()}calculateInlines(e){const t=this.content,r=this.getFontFamily(),s=this.getBreakOn(),a=this.getTextType(),i=this.getWhiteSpace();if(!r||"string"==typeof r)return void(A.getFontOf(this)||console.warn("no font was found"));if(!this.content)return void(this.inlines=null);if(!a)return void console.error("You must provide a 'textType' attribute so three-mesh-ui knows how to render your text.\n See https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type");const n=w(t,i),o=Array.from?Array.from(n):String(n).split(""),h=e/r.info.size,c=r.common.lineHeight*h,d=r.common.base*h,u=o.map((t=>{const n=this.getGlyphDimensions({textType:a,glyph:t,font:r,fontSize:e});let o=null;return i!==l&&(s.includes(t)||t.match(/\s/g))&&(o="possible"),t.match(/\n/g)&&(o=C(i)),{height:n.height,width:n.width,anchor:n.anchor,xadvance:n.xadvance,xoffset:n.xoffset,lineBreak:o,glyph:t,fontSize:e,lineHeight:c,lineBase:d}}));if("none"!==this.getFontKerning())for(let t=1;t<u.length;t++){const s=u[t],i=u[t-1].glyph+u[t].glyph,n=this.getGlyphPairKerning(a,r,i);s.kerning=n*(e/r.info.size)}this.inlines=u}}class he extends(Z.withBase(s.Object3D)(te,a,B,Y,X)){constructor(e){super(e),this.isInlineBlock=!0,this.size=new s.Vector2(1,1),this.frame=new $(this.getBackgroundMaterial()),this.frame.onBeforeRender=()=>{this.updateClippingPlanes&&this.updateClippingPlanes()},this.add(this.frame),this.set(e)}parseParams(){this.width||console.warn("inlineBlock has no width. Set to 0.3 by default"),this.height||console.warn("inlineBlock has no height. Set to 0.3 by default"),this.inlines=[{height:this.height||.3,width:this.width||.3,anchor:0,lineBreak:"possible"}]}updateLayout(){const e=this.getWidth(),t=this.getHeight();if(this.inlines){const e=this.inlines[0];this.position.set(e.width/2,e.height/2,0),this.position.x+=e.offsetX,this.position.y+=e.offsetY}this.size.set(e,t),this.frame.scale.set(e,t,1),this.frame&&this.updateBackgroundMaterial(),this.frame.renderOrder=this.getParentsNumber(),this.children.find((e=>e.isInline))&&this.computeInlinesPosition(),this.computeChildrenPosition(),this.position.z=this.getOffset()}updateInner(){this.position.z=this.getOffset(),this.frame&&this.updateBackgroundMaterial()}}const ce=[[[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]}],[{width:.2,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],le=[[[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],de=[[[{width:1/12,chars:[{lowerCase:"й",upperCase:"Й"},{lowerCase:"q",upperCase:"Q"}]},{width:1/12,chars:[{lowerCase:"ц",upperCase:"Ц"},{lowerCase:"w",upperCase:"W"}]},{width:1/12,chars:[{lowerCase:"у",upperCase:"У"},{lowerCase:"e",upperCase:"E"}]},{width:1/12,chars:[{lowerCase:"к",upperCase:"К"},{lowerCase:"r",upperCase:"R"}]},{width:1/12,chars:[{lowerCase:"е",upperCase:"Е"},{lowerCase:"t",upperCase:"T"}]},{width:1/12,chars:[{lowerCase:"н",upperCase:"Н"},{lowerCase:"y",upperCase:"Y"}]},{width:1/12,chars:[{lowerCase:"г",upperCase:"Г"},{lowerCase:"u",upperCase:"U"}]},{width:1/12,chars:[{lowerCase:"ш",upperCase:"Ш"},{lowerCase:"i",upperCase:"I"}]},{width:1/12,chars:[{lowerCase:"щ",upperCase:"Щ"},{lowerCase:"o",upperCase:"O"}]},{width:1/12,chars:[{lowerCase:"з",upperCase:"З"},{lowerCase:"p",upperCase:"P"}]},{width:1/12,chars:[{lowerCase:"х",upperCase:"Х"},{lowerCase:"{",upperCase:"["}]},{width:1/12,chars:[{lowerCase:"ъ",upperCase:"Ъ"},{lowerCase:"}",upperCase:"]"}]}],[{width:1/12,chars:[{lowerCase:"ф",upperCase:"Ф"},{lowerCase:"a",upperCase:"A"}]},{width:1/12,chars:[{lowerCase:"ы",upperCase:"Ы"},{lowerCase:"s",upperCase:"S"}]},{width:1/12,chars:[{lowerCase:"в",upperCase:"В"},{lowerCase:"d",upperCase:"D"}]},{width:1/12,chars:[{lowerCase:"а",upperCase:"А"},{lowerCase:"f",upperCase:"F"}]},{width:1/12,chars:[{lowerCase:"п",upperCase:"П"},{lowerCase:"g",upperCase:"G"}]},{width:1/12,chars:[{lowerCase:"р",upperCase:"Р"},{lowerCase:"h",upperCase:"H"}]},{width:1/12,chars:[{lowerCase:"о",upperCase:"О"},{lowerCase:"j",upperCase:"J"}]},{width:1/12,chars:[{lowerCase:"л",upperCase:"Л"},{lowerCase:"k",upperCase:"K"}]},{width:1/12,chars:[{lowerCase:"д",upperCase:"Д"},{lowerCase:"l",upperCase:"L"}]},{width:1/12,chars:[{lowerCase:"ж",upperCase:"Ж"},{lowerCase:":",upperCase:";"}]},{width:1/12,chars:[{lowerCase:"э",upperCase:"Э"},{lowerCase:'"',upperCase:"'"}]},{width:1/12,chars:[{lowerCase:"ё",upperCase:"Ё"},{lowerCase:"|",upperCase:"\\"}]}],[{width:.125,command:"shift",chars:[{icon:"shift"}]},{width:1/12,chars:[{lowerCase:"я",upperCase:"Я"},{lowerCase:"z",upperCase:"Z"}]},{width:1/12,chars:[{lowerCase:"ч",upperCase:"Ч"},{lowerCase:"x",upperCase:"X"}]},{width:1/12,chars:[{lowerCase:"с",upperCase:"С"},{lowerCase:"c",upperCase:"C"}]},{width:1/12,chars:[{lowerCase:"м",upperCase:"М"},{lowerCase:"v",upperCase:"V"}]},{width:1/12,chars:[{lowerCase:"и",upperCase:"И"},{lowerCase:"b",upperCase:"B"}]},{width:1/12,chars:[{lowerCase:"т",upperCase:"Т"},{lowerCase:"n",upperCase:"N"}]},{width:1/12,chars:[{lowerCase:"ь",upperCase:"Ь"},{lowerCase:"m",upperCase:"M"}]},{width:1/12,chars:[{lowerCase:"б",upperCase:"Б"},{lowerCase:",",upperCase:""}]},{width:1/12,chars:[{lowerCase:"ю",upperCase:"Ю"},{lowerCase:".",upperCase:""}]},{width:.125,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.15,command:"switch-set",chars:[{lowerCase:"eng"}]},{width:.15,command:"switch",chars:[{lowerCase:".?12"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.3,command:"switch",chars:[{lowerCase:"АБВ"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],ue=[[[{width:1/11,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:1/11,chars:[{lowerCase:"w",upperCase:"W"}]},{width:1/11,chars:[{lowerCase:"e",upperCase:"E"}]},{width:1/11,chars:[{lowerCase:"r",upperCase:"R"}]},{width:1/11,chars:[{lowerCase:"t",upperCase:"T"}]},{width:1/11,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:1/11,chars:[{lowerCase:"u",upperCase:"U"}]},{width:1/11,chars:[{lowerCase:"i",upperCase:"I"}]},{width:1/11,chars:[{lowerCase:"o",upperCase:"O"}]},{width:1/11,chars:[{lowerCase:"p",upperCase:"P"}]},{width:1/11,chars:[{lowerCase:"ü",upperCase:"Ü"}]}],[{width:1/11,chars:[{lowerCase:"a",upperCase:"A"}]},{width:1/11,chars:[{lowerCase:"s",upperCase:"S"}]},{width:1/11,chars:[{lowerCase:"d",upperCase:"D"}]},{width:1/11,chars:[{lowerCase:"f",upperCase:"F"}]},{width:1/11,chars:[{lowerCase:"g",upperCase:"G"}]},{width:1/11,chars:[{lowerCase:"h",upperCase:"H"}]},{width:1/11,chars:[{lowerCase:"j",upperCase:"J"}]},{width:1/11,chars:[{lowerCase:"k",upperCase:"K"}]},{width:1/11,chars:[{lowerCase:"l",upperCase:"L"}]},{width:1/11,chars:[{lowerCase:"ö",upperCase:"Ö"}]},{width:1/11,chars:[{lowerCase:"ä",upperCase:"Ä"}]}],[{width:2/11,command:"shift",chars:[{icon:"shift"}]},{width:1/11,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:1/11,chars:[{lowerCase:"x",upperCase:"X"}]},{width:1/11,chars:[{lowerCase:"c",upperCase:"C"}]},{width:1/11,chars:[{lowerCase:"v",upperCase:"V"}]},{width:1/11,chars:[{lowerCase:"b",upperCase:"B"}]},{width:1/11,chars:[{lowerCase:"n",upperCase:"N"}]},{width:1/11,chars:[{lowerCase:"m",upperCase:"M"}]},{width:2/11,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],pe=[[[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]},{width:.1,chars:[{lowerCase:"ñ",upperCase:"Ñ"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],we=[[[{width:.1,chars:[{lowerCase:";",upperCase:":"},{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"ς",upperCase:"ς"},{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"ε",upperCase:"Ε"},{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"ρ",upperCase:"Ρ"},{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"τ",upperCase:"Τ"},{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"υ",upperCase:"Υ"},{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"θ",upperCase:"Θ"},{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"ι",upperCase:"Ι"},{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"ο",upperCase:"Ο"},{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"π",upperCase:"Π"},{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"α",upperCase:"Α"},{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"σ",upperCase:"Σ"},{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"δ",upperCase:"Δ"},{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"φ",upperCase:"Φ"},{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"γ",upperCase:"Γ"},{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"η",upperCase:"Η"},{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"ξ",upperCase:"Ξ"},{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"κ",upperCase:"Κ"},{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"λ",upperCase:"Λ"},{lowerCase:"l",upperCase:"L"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"ζ",upperCase:"Ζ"},{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"χ",upperCase:"Χ"},{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"ψ",upperCase:"Ψ"},{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"ω",upperCase:"Ω"},{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"β",upperCase:"Β"},{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"ν",upperCase:"Ν"},{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"μ",upperCase:"Μ"},{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.15,command:"switch-set",chars:[{lowerCase:"eng"}]},{width:.15,command:"switch",chars:[{lowerCase:".?12"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ce=[[[{width:1/11,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:1/11,chars:[{lowerCase:"w",upperCase:"W"}]},{width:1/11,chars:[{lowerCase:"e",upperCase:"E"}]},{width:1/11,chars:[{lowerCase:"r",upperCase:"R"}]},{width:1/11,chars:[{lowerCase:"t",upperCase:"T"}]},{width:1/11,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:1/11,chars:[{lowerCase:"u",upperCase:"U"}]},{width:1/11,chars:[{lowerCase:"i",upperCase:"I"}]},{width:1/11,chars:[{lowerCase:"o",upperCase:"O"}]},{width:1/11,chars:[{lowerCase:"p",upperCase:"P"}]},{width:1/11,chars:[{lowerCase:"å",upperCase:"Å"}]}],[{width:1/11,chars:[{lowerCase:"a",upperCase:"A"}]},{width:1/11,chars:[{lowerCase:"s",upperCase:"S"}]},{width:1/11,chars:[{lowerCase:"d",upperCase:"D"}]},{width:1/11,chars:[{lowerCase:"f",upperCase:"F"}]},{width:1/11,chars:[{lowerCase:"g",upperCase:"G"}]},{width:1/11,chars:[{lowerCase:"h",upperCase:"H"}]},{width:1/11,chars:[{lowerCase:"j",upperCase:"J"}]},{width:1/11,chars:[{lowerCase:"k",upperCase:"K"}]},{width:1/11,chars:[{lowerCase:"l",upperCase:"L"}]},{width:1/11,chars:[{lowerCase:"æ",upperCase:"Æ"}]},{width:1/11,chars:[{lowerCase:"ø",upperCase:"Ø"}]}],[{width:2/11,command:"shift",chars:[{icon:"shift"}]},{width:1/11,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:1/11,chars:[{lowerCase:"x",upperCase:"X"}]},{width:1/11,chars:[{lowerCase:"c",upperCase:"C"}]},{width:1/11,chars:[{lowerCase:"v",upperCase:"V"}]},{width:1/11,chars:[{lowerCase:"b",upperCase:"B"}]},{width:1/11,chars:[{lowerCase:"n",upperCase:"N"}]},{width:1/11,chars:[{lowerCase:"m",upperCase:"M"}]},{width:2/11,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],ge=new s.TextureLoader;class fe extends(Z.withBase(s.Object3D)(a,X)){constructor(e){let t;if(e||(e={}),e.width||(e.width=1),e.height||(e.height=.4),e.margin||(e.margin=.003),e.padding||(e.padding=.01),super(e),this.currentPanel=0,this.isLowerCase=!0,this.charsetCount=1,e.language||navigator.language)switch(e.language||navigator.language){case"fr":case"fr-CH":case"fr-CA":t=ce;break;case"ru":this.charsetCount=2,t=de;break;case"de":case"de-DE":case"de-AT":case"de-LI":case"de-CH":t=ue;break;case"es":case"es-419":case"es-AR":case"es-CL":case"es-CO":case"es-ES":case"es-CR":case"es-US":case"es-HN":case"es-MX":case"es-PE":case"es-UY":case"es-VE":t=pe;break;case"el":this.charsetCount=2,t=we;break;case"nord":t=Ce;break;default:t=le}else t=le;this.keys=[],this.panels=t.map((t=>{const r=e.height/t.length-2*e.margin,s=new ee({width:e.width+2*e.padding,height:e.height+2*e.padding,offset:0,padding:e.padding,fontFamily:e.fontFamily,fontTexture:e.fontTexture,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity});return s.charset=0,s.add(...t.map((t=>{const a=new ee({width:e.width,height:r,margin:e.margin,contentDirection:"row",justifyContent:"center"});a.frame.visible=!1;const i=[];return t.forEach((t=>{const a=new ee({width:e.width*t.width-2*e.margin,height:r,margin:e.margin,justifyContent:"center",offset:0}),n=t.chars[s.charset].lowerCase||t.chars[s.charset].icon||"undif";if("enter"===n&&e.enterTexture||"shift"===n&&e.shiftTexture||"backspace"===n&&e.backspaceTexture){const t=(()=>{switch(n){case"backspace":return e.backspaceTexture;case"enter":return e.enterTexture;case"shift":return e.shiftTexture;default:console.warn("There is no icon image for this key")}})();ge.load(t,(e=>{a.add(new he({width:.65*a.width,height:.65*a.height,backgroundSize:"contain",backgroundTexture:e}))}))}else a.add(new oe({content:n,offset:0}));a.type="Key",a.info=t,a.info.input=n,a.panel=s,i.push(a),this.keys.push(a)})),a.add(...i),a}))),s})),this.add(this.panels[0]),this.set(e)}setNextPanel(){this.panels.forEach((e=>{this.remove(e)})),this.currentPanel=(this.currentPanel+1)%this.panels.length,this.add(this.panels[this.currentPanel]),this.update(!0,!0,!0)}setNextCharset(){this.panels[this.currentPanel].charset=(this.panels[this.currentPanel].charset+1)%this.charsetCount,this.keys.forEach((e=>{if(!this.panels[this.currentPanel].getObjectById(e.id))return;const t=e.info.chars[e.panel.charset]||e.info.chars[0],r=this.isLowerCase||!t.upperCase?t.lowerCase:t.upperCase,s=e.children.find((e=>e.isText));s&&(e.info.input=r,s.set({content:r}),s.update(!0,!0,!0))}))}toggleCase(){this.isLowerCase=!this.isLowerCase,this.keys.forEach((e=>{const t=e.info.chars[e.panel.charset]||e.info.chars[0],r=this.isLowerCase||!t.upperCase?t.lowerCase:t.upperCase,s=e.children.find((e=>e.isText));s&&(e.info.input=r,s.set({content:r}),s.update(!0,!0,!0))}))}parseParams(){}updateLayout(){}updateInner(){}}const me={Block:ee,Text:oe,InlineBlock:he,Keyboard:fe,FontLibrary:A,update:()=>W.update(),textAlign:r,whiteSpace:t};void 0!==e.g&&(e.g.ThreeMeshUI=me)})();